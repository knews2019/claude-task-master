# Application Prompts and Rules

This document outlines the various prompts and rules used within the Task Master application, including those defined in `.mdc` rule files and those embedded within the codebase.

---
## AddTaskSystemPrompt
**Role:** Instructs the AI to act as a helpful assistant for creating well-structured software development tasks, adhering to a JSON schema, and paying attention to dependencies.
**Usage:** scripts/modules/task-manager/add-task.js, within addTask function
**Trigger:** Called when 'addTask' is invoked without manualTaskData, for AI-based task generation (e.g., `task-master add-task` CLI or `add_task` MCP tool).
---
## AddTaskUserPrompt
**Role:** Provides the AI with the user's task request, context about existing tasks (dependencies, related tasks, recent tasks, common patterns), and the JSON schema for the new task.
**Usage:** scripts/modules/task-manager/add-task.js, within addTask function
**Trigger:** Called when 'addTask' is invoked without manualTaskData, for AI-based task generation.
---
## GenerateInternalComplexityAnalysisPrompt
**Role:** Instructs the AI to analyze tasks, determine complexity (1-10), recommend subtask count, and provide reasoning and an initial expansion prompt for each, in a specific JSON format.
**Usage:** scripts/modules/task-manager/analyze-task-complexity.js, in generateInternalComplexityAnalysisPrompt function, used by analyzeTaskComplexity function.
**Trigger:** When `analyzeTaskComplexity` is called (e.g., `task-master analyze-complexity` CLI or `analyze_project_complexity` MCP tool).
---
## AnalyzeComplexitySystemPrompt
**Role:** Instructs the AI that it's an expert software architect and project manager analyzing task complexity, and it should respond only with the requested valid JSON array.
**Usage:** scripts/modules/task-manager/analyze-task-complexity.js, within analyzeTaskComplexity function.
**Trigger:** When `analyzeTaskComplexity` is called.
---
## ExpandTaskMainSystemPrompt
**Role:** Instructs the AI (main role) on how to break down a high-level task into a specific number of subtasks, detailing requirements for subtask structure, sequence, content, and JSON output format.
**Usage:** scripts/modules/task-manager/expand-task.js, generated by generateMainSystemPrompt function.
**Trigger:** When `expandTask` is called without research mode and no specific expansion prompt from a complexity report is used (e.g., `task-master expand` or `expand_task` MCP tool).
---
## ExpandTaskMainUserPrompt
**Role:** Provides the AI (main role) with parent task details, target subtask count, additional context, starting subtask ID, and expected JSON schema.
**Usage:** scripts/modules/task-manager/expand-task.js, generated by generateMainUserPrompt function.
**Trigger:** When `expandTask` is called without research mode and no specific expansion prompt from a complexity report is used.
---
## ExpandTaskResearchUserPrompt
**Role:** Instructs the AI (research role) to analyze a parent task and break it down into subtasks using research capabilities, adhering to JSON output.
**Usage:** scripts/modules/task-manager/expand-task.js, generated by generateResearchUserPrompt function.
**Trigger:** When `expandTask` is called with research mode enabled and no specific expansion prompt from a complexity report is used.
---
## ExpandTaskSimplifiedSystemPromptForReport
**Role:** A simplified system prompt for when an expansion prompt is already provided by a complexity report, focusing on JSON output structure for a specific number of subtasks.
**Usage:** scripts/modules/task-manager/expand-task.js, within expandTask function, when taskAnalysis.expansionPrompt is available.
**Trigger:** When `expandTask` is called and uses a pre-defined expansion prompt from a complexity analysis report.
---
## ComplexityReportExpansionUserPrompt
**Role:** Varies based on the content of taskAnalysis.expansionPrompt; guides AI to expand a task based on prior complexity analysis.
**Usage:** scripts/modules/task-manager/expand-task.js, content of taskAnalysis.expansionPrompt used as promptContent.
**Trigger:** When `expandTask` is called and uses an expansion prompt from a complexity report.
---
## ParsePRDSystemPrompt
**Role:** Instructs AI to analyze a PRD, generate tasks in JSON, manage dependencies, and adhere to PRD requirements, incorporating research if enabled.
**Usage:** scripts/modules/task-manager/parse-prd.js, within parsePRD function.
**Trigger:** When `parsePRD` is called (e.g., `task-master parse-prd` CLI or `parse_prd` MCP tool).
---
## ParsePRDUserPrompt
**Role:** Provides AI with PRD content, target task count, starting ID, and metadata instructions, reminding about research if enabled.
**Usage:** scripts/modules/task-manager/parse-prd.js, within parsePRD function.
**Trigger:** When `parsePRD` is called.
---
## UpdateSubtaskSystemPrompt
**Role:** Guides AI to generate new text to append to a subtask's details based on user request and context, returning only plain new text.
**Usage:** scripts/modules/task-manager/update-subtask-by-id.js, within updateSubtaskById function.
**Trigger:** When `updateSubtaskById` is called (e.g., `task-master update-subtask` CLI or `update_subtask` MCP tool).
---
## UpdateSubtaskUserPrompt
**Role:** Provides AI with context (parent/sibling subtasks, current details) and the user's request for appending information to a subtask.
**Usage:** scripts/modules/task-manager/update-subtask-by-id.js, within updateSubtaskById function.
**Trigger:** When `updateSubtaskById` is called.
---
## UpdateSingleTaskSystemPrompt
**Role:** Instructs AI to update a task based on new context, preserving ID/title/status/dependencies (unless specified), and carefully handling completed subtasks by adding new ones for changes.
**Usage:** scripts/modules/task-manager/update-task-by-id.js, within updateTaskById function.
**Trigger:** When `updateTaskById` is called (e.g., `task-master update-task` CLI or `update_task` MCP tool).
---
## UpdateSingleTaskUserPrompt
**Role:** Provides AI with the task JSON to update and new user context, emphasizing preservation of completed subtasks.
**Usage:** scripts/modules/task-manager/update-task-by-id.js, within updateTaskById function.
**Trigger:** When `updateTaskById` is called.
---
## UpdateMultipleTasksSystemPrompt
**Role:** Instructs AI to update a set of tasks based on new context, preserving structure and completed subtasks (similar to single task update but for multiple tasks).
**Usage:** scripts/modules/task-manager/update-tasks.js, within updateTasks function.
**Trigger:** When `updateTasks` is called (e.g., `task-master update` CLI or `update` MCP tool).
---
## UpdateMultipleTasksUserPrompt
**Role:** Provides AI with a JSON array of tasks to update and new user context, reminding to return all tasks and preserve completed subtasks.
**Usage:** scripts/modules/task-manager/update-tasks.js, within updateTasks function.
**Trigger:** When `updateTasks` is called.

---
## ai_providers.mdc
**Role:** Guidelines for managing Task Master AI providers and models.
**Usage:** N/A
**Trigger:** When specific files are open or by direct invocation
---
## ai_services.mdc
**Role:** Guidelines for interacting with the unified AI service layer.
**Usage:** scripts/modules/ai-services-unified.js, scripts/modules/task-manager/*.js, scripts/modules/commands.js
**Trigger:** N/A
---
## architecture.mdc
**Role:** Describes the high-level architecture of the Task Master CLI application.
**Usage:** scripts/modules/*.js
**Trigger:** When specific files are open or by direct invocation
---
## changeset.mdc
**Role:** Guidelines for using Changesets (npm run changeset) to manage versioning and changelogs.
**Usage:** N/A
**Trigger:** Always
---
## commands.mdc
**Role:** Guidelines for implementing CLI commands using Commander.js
**Usage:** scripts/modules/commands.js
**Trigger:** When specific files are open or by direct invocation
---
## cursor_rules.mdc
**Role:** Guidelines for creating and maintaining Cursor rules to ensure consistency and effectiveness.
**Usage:** .cursor/rules/*.mdc
**Trigger:** Always
---
## dependencies.mdc
**Role:** Guidelines for managing task dependencies and relationships
**Usage:** scripts/modules/dependency-manager.js
**Trigger:** When specific files are open or by direct invocation
---
## dev_workflow.mdc
**Role:** Guide for using Task Master to manage task-driven development workflows
**Usage:** **/*
**Trigger:** Always
---
## glossary.mdc
**Role:** Glossary of other Cursor rules
**Usage:** **/*
**Trigger:** Always
---
## mcp.mdc
**Role:** Guidelines for implementing and interacting with the Task Master MCP Server
**Usage:** mcp-server/src/**/*, scripts/modules/**/*
**Trigger:** When specific files are open or by direct invocation
---
## new_features.mdc
**Role:** Guidelines for integrating new features into the Task Master CLI
**Usage:** scripts/modules/*.js
**Trigger:** When specific files are open or by direct invocation
---
## self_improve.mdc
**Role:** Guidelines for continuously improving Cursor rules based on emerging code patterns and best practices.
**Usage:** **/*
**Trigger:** Always
---
## taskmaster.mdc
**Role:** Comprehensive reference for Taskmaster MCP tools and CLI commands.
**Usage:** **/*
**Trigger:** Always
---
## tasks.mdc
**Role:** Guidelines for implementing task management operations
**Usage:** scripts/modules/task-manager.js
**Trigger:** When specific files are open or by direct invocation
---
## telemetry.mdc
**Role:** Guidelines for integrating AI usage telemetry across Task Master.
**Usage:** scripts/modules/**/*.js,mcp-server/src/**/*.js
**Trigger:** Always
---
## tests.mdc
**Role:** Guidelines for implementing and maintaining tests for Task Master CLI
**Usage:** **/*.test.js,tests/**/*
**Trigger:** N/A
---
## ui.mdc
**Role:** Guidelines for implementing and maintaining user interface components
**Usage:** scripts/modules/ui.js
**Trigger:** When specific files are open or by direct invocation
---
## utilities.mdc
**Role:** Guidelines for implementing utility functions
**Usage:** scripts/modules/utils.js, mcp-server/src/**/*
**Trigger:** When specific files are open or by direct invocation

